// ===============================
// createUiDefinition.json - Portal UI Definition for SecurityAlert-Only Deployment (Fixed Boolean UI)
// ===============================
{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/uiDefinition.json#",
  "handler": "Microsoft.Resources.CreateUiDefinition",
  "version": "1.0.0",
  "parameters": {
    "basics": [
      {
        "name": "workspaceName",
        "type": "Microsoft.Common.TextBox",
        "label": "Log Analytics Workspace Name",
        "toolTip": "Enter the name of your existing Log Analytics workspace."
      },
      {
        "name": "workspaceResourceGroup",
        "type": "Microsoft.Common.ResourceGroupPicker",
        "label": "Resource Group",
        "toolTip": "Select the resource group that contains the Log Analytics workspace."
      }
    ],
    "steps": [
      {
        "name": "selectLogs",
        "label": "Select Security Alert Log Sources",
        "elements": [
          {
            "name": "AzureActivity",
            "type": "Microsoft.Common.Toggle",
            "label": "Azure Activity Logs",
            "defaultValue": false
          },
          {
            "name": "SentinelHealth",
            "type": "Microsoft.Common.Toggle",
            "label": "Sentinel Health Monitoring",
            "defaultValue": false
          },
          {
            "name": "Office365",
            "type": "Microsoft.Common.Toggle",
            "label": "Office 365 Logs",
            "defaultValue": false
          },
          {
            "name": "EntraRiskAlerts",
            "type": "Microsoft.Common.Toggle",
            "label": "Entra ID Protection Alerts",
            "defaultValue": false
          },
          {
            "name": "DefenderEndpoint",
            "type": "Microsoft.Common.Toggle",
            "label": "Defender for Endpoint (MDATP)",
            "defaultValue": false
          },
          {
            "name": "DefenderIdentity",
            "type": "Microsoft.Common.Toggle",
            "label": "Defender for Identity (AATP)",
            "defaultValue": false
          },
          {
            "name": "DefenderCloudApps",
            "type": "Microsoft.Common.Toggle",
            "label": "Defender for Cloud Apps (MCAS)",
            "defaultValue": false
          },
          {
            "name": "DefenderCloud",
            "type": "Microsoft.Common.Toggle",
            "label": "Defender for Cloud",
            "defaultValue": false
          },
          {
            "name": "DefenderIoT",
            "type": "Microsoft.Common.Toggle",
            "label": "Defender for IoT",
            "defaultValue": false
          },
          {
            "name": "DefenderXDRAlerts",
            "type": "Microsoft.Common.Toggle",
            "label": "Defender XDR - Alerts",
            "defaultValue": false
          },
          {
            "name": "DefenderXDRIncidents",
            "type": "Microsoft.Common.Toggle",
            "label": "Defender XDR - Incidents",
            "defaultValue": false
          }
        ]
      }
    ],
    "outputs": {
      "workspaceName": "[parameters('workspaceName')]",
      "workspaceResourceGroup": "[parameters('workspaceResourceGroup')]",
      "logSources": "[union(
        if(steps('selectLogs').AzureActivity, ['AzureActivity'], []),
        if(steps('selectLogs').SentinelHealth, ['SentinelHealth'], []),
        if(steps('selectLogs').Office365, ['Office365'], []),
        if(steps('selectLogs').EntraRiskAlerts, ['EntraRiskAlerts'], []),
        if(steps('selectLogs').DefenderEndpoint, ['DefenderEndpoint'], []),
        if(steps('selectLogs').DefenderIdentity, ['DefenderIdentity'], []),
        if(steps('selectLogs').DefenderCloudApps, ['DefenderCloudApps'], []),
        if(steps('selectLogs').DefenderCloud, ['DefenderCloud'], []),
        if(steps('selectLogs').DefenderIoT, ['DefenderIoT'], []),
        if(steps('selectLogs').DefenderXDRAlerts, ['DefenderXDRAlerts'], []),
        if(steps('selectLogs').DefenderXDRIncidents, ['DefenderXDRIncidents'], [])
      )]"
    }
  }
}
